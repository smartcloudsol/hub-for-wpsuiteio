var G=Object.defineProperty;var l=(e,t)=>()=>(e&&(t=e(e=0)),t);var I=(e,t)=>{for(var n in t)G(e,n,{get:t[n],enumerable:!0})};function d(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");for(;t.length%4;)t+="=";return Uint8Array.from(atob(t),n=>n.charCodeAt(0))}var m,M,f=l(()=>{"use strict";m=(e,t)=>{let s=Uint8Array.from(atob(e),i=>i.charCodeAt(0)).map((i,o)=>i^t+o&255);return new TextDecoder().decode(s)},M=async e=>{let t=globalThis.grecaptcha,n=e?t?.enterprise:void 0,s=n?.ready??t?.ready,i=n?.execute??t?.execute;if(typeof i!="function")return{execute:void 0};try{return typeof s=="function"&&await new Promise(o=>s(()=>o())),{execute:i}}catch{return{execute:void 0}}}});function b(e,t){return`wpsuite:${e}:${t}`}function Y(e,t=8e3){return()=>new Promise(n=>{if(e.status==="available")return n("available");if(e.status==="error")return n("error");!e.status||e.status;let s=b(e.key,"ready"),i=b(e.key,"error"),o=()=>r("available"),p=()=>r("error"),a,r=u=>{window.removeEventListener(s,o),window.removeEventListener(i,p),a!==void 0&&window.clearTimeout(a),n(u)};window.addEventListener(s,o,{once:!0}),window.addEventListener(i,p,{once:!0}),a=window.setTimeout(()=>r("unavailable"),t)})}function N(e){return t=>{window.addEventListener(b(e,"ready"),()=>t(),{once:!0})}}function V(e,t){let n=t?.timeoutMs??8e3;return e.availability??=Y(e,n),e.onReady??=N(e.key),e}var P=l(()=>{"use strict"});var x,E,_=l(()=>{"use strict";f();x=m("ISEsOw4RHR5NRSEJ6Oe35/DU1u76wrv90+K758qi9uDM/vr56srI/tal+Q==",116),E=m("I0E0DT8KADgTGRo+4/Tx7Mb89MPDxuHT/um2wN/wzdzw9M7lwNHu76ztyw==",116)});var T={};I(T,{getConfig:()=>ee});import{parse as F}from"tldts";function v(e){try{return new URL(e.includes("://")?e:`http://${e}`).hostname.toLowerCase()}catch{return e.replace(/\/+$/,"").toLowerCase()}}function Z(e){let t=v(e);return t.startsWith("www.")?t.slice(4):t}function C(e){let t=v(e);if(J.test(t)||$.test(t)||t==="localhost")return!0;let n=F(t,{allowPrivateDomains:!0});return!!(!n.domain||!n.publicSuffix||H.includes(n.publicSuffix))}function j(e){let t=v(e);return C(t)||R.test(t)?!0:t.split(".").some(n=>R.test(n))}function z(e){return C(e)||j(e)}function q(e,t){return t?Z(e)===t:!1}function Q(e,t){return z(e)?{free:!0,covered:!0}:{free:!1,covered:q(e,t)}}var A,k,c,w,R,H,J,$,ee,W=l(()=>{"use strict";_();f();B();c=L();c?w=c.siteSettings:w={};R=/\b(dev|test|testing|staging|stage|qa|uat|preview|demo|sandbox|preprod|beta|canary)\b/i,H=["localhost","local","test","invalid","example","lan","internal"],J=/^(127\.)|^(10\.)|^(192\.168\.)|^(172\.(1[6-9]|2\d|3[0-1])\.)/,$=/^(::1$)|(^fc00:)|(^fd)/i;ee=async()=>{let{jwtVerify:e,importJWK:t}=await import("jose"),n=null;if(w.subscriber){let i=await t({kty:"EC",x:A,y:k,crv:"P-256"},"ES256"),o=new Date().getFullYear(),p=Math.floor((Date.now()-new Date(o,0,1).getTime())/(1e3*60*60*24*7)),a=await fetch(c.uploadUrl+"lic.jws?t="+c.siteSettings.lastUpdate+"&y="+o+"&w="+p).then(r=>r.ok?r.text():null).catch(()=>null);if(a)try{let r=location.hostname.split(":")[0],{payload:u}=await e(a,i,{algorithms:["ES256"]}),S=Q(r,u.domain);if(!S.free&&!S.covered)throw new Error("Invalid domain in JWT");let h=u.key.split(":"),U=d(h[0]),K=d(h[1]),y=(await fetch(c.uploadUrl+"config.enc?t="+c.siteSettings.lastUpdate).then(g=>g.ok?g.text():null).catch(()=>null))?.split(":");if(y?.length===2){let g=d(y[0]),D=d(y[1]),O=await crypto.subtle.importKey("raw",U,{name:"AES-GCM"},!1,["decrypt"]),X=await crypto.subtle.decrypt({name:"AES-GCM",iv:K},O,new Uint8Array([...g,...D]));n=JSON.parse(new TextDecoder().decode(X)),n.subscriptionType=u.subscriptionType}}catch(r){console.error(r.message)}}return n??null};A=x;k=E});function L(){return globalThis.WpSuite}function de(e){return globalThis.WpSuite?.plugins[e]}var pe,ge,B=l(()=>{f();P();pe="smartcloud-wpsuite",ge=async e=>{let n=await(await Promise.resolve().then(()=>(W(),T))).getConfig();return n&&(n={...n[e],subscriptionType:n.subscriptionType}),n}});B();export{pe as TEXT_DOMAIN,V as attachDefaultPluginRuntime,ge as getConfig,de as getPlugin,M as getRecaptcha,L as getWpSuite};

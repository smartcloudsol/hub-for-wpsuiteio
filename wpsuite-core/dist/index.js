var L=Object.defineProperty;var g=(t,e)=>()=>(t&&(e=t(t=0)),e);var W=(t,e)=>{for(var n in e)L(t,n,{get:e[n],enumerable:!0})};function u(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");for(;e.length%4;)e+="=";return Uint8Array.from(atob(e),n=>n.charCodeAt(0))}var B,l,K,f=g(()=>{"use strict";B=async t=>{let e=l("emUgRnVEemN0U1BhUXB3amlxc1h0dm9JQklUbXh5Z2YaSRZeZ2EABH5lZgU=",t),n=Uint8Array.from(atob(e),r=>r.charCodeAt(0));return window.crypto.subtle.importKey("raw",n,{name:"AES-CBC",length:256},!1,["decrypt"])},l=(t,e)=>{let r=Uint8Array.from(atob(t),i=>i.charCodeAt(0)).map((i,s)=>i^e+s&255);return new TextDecoder().decode(r)},K=async(t,e)=>{if(t==="")return Promise.resolve({});try{let[n,r]=t.split(":"),i=await B(e),s=new Uint8Array(atob(n).split("").map(a=>a.charCodeAt(0))),o=new Uint8Array(atob(r).split("").map(a=>a.charCodeAt(0))),c=await window.crypto.subtle.decrypt({name:"AES-CBC",iv:s},i,o);return JSON.parse(new TextDecoder().decode(c))}catch(n){console.error(n);return}}});var w,S,_=g(()=>{"use strict";f();w=l("XlhXQnl4dnciLEpgf34sfm9NTXdtaxBUfEsQTn0bTVlzR0FAXWNjV3kMUg==",11),S=l("XDhPdEhja1F8cHFXdG1qdVllb1pUb0p6UUAdaWhJdmVPTXVcd3hFRgNEYA==",11)});var A={};W(A,{getConfig:()=>Z});import{importJWK as X,jwtVerify as D}from"jose";import{parse as O}from"tldts";function m(t){try{return new URL(t.includes("://")?t:`http://${t}`).hostname.toLowerCase()}catch{return t.replace(/\/+$/,"").toLowerCase()}}function M(t){let e=m(t);return e.startsWith("www.")?e.slice(4):e}function x(t){let e=m(t);if(Y.test(e)||N.test(e)||e==="localhost")return!0;let n=O(e,{allowPrivateDomains:!0});return!!(!n.domain||!n.publicSuffix||I.includes(n.publicSuffix))}function G(t){let e=m(t);return x(e)||h.test(e)?!0:e.split(".").some(n=>h.test(n))}function H(t){return x(t)||G(t)}function J(t,e){return e?M(t)===e:!1}function V(t,e){return H(t)?{free:!0,covered:!0}:{free:!1,covered:J(t,e)}}var E,C,y,h,I,Y,N,Z,P=g(()=>{"use strict";_();f();typeof WpSuite<"u"?y=WpSuite.siteSettings:y={};h=/\b(dev|test|testing|staging|stage|qa|uat|preview|demo|sandbox|preprod|beta|canary)\b/i,I=["localhost","local","test","invalid","example","lan","internal"],Y=/^(127\.)|^(10\.)|^(192\.168\.)|^(172\.(1[6-9]|2\d|3[0-1])\.)/,N=/^(::1$)|(^fc00:)|(^fd)/i;Z=async()=>{let t=null;if(y.subscriber){let n=await X({kty:"EC",x:E,y:C,crv:"P-256"},"ES256"),r=new Date().getFullYear(),i=Math.floor((Date.now()-new Date(r,0,1).getTime())/(1e3*60*60*24*7)),s=await fetch(WpSuite.uploadUrl+"lic.jws?t="+WpSuite.siteSettings.lastUpdate+"&y="+r+"&w="+i).then(o=>o.ok?o.text():null).catch(()=>null);if(s)try{let o=location.hostname.split(":")[0],{payload:c}=await D(s,n,{algorithms:["ES256"]}),a=V(o,c.domain);if(!a.free&&!a.covered)throw new Error("Invalid domain in JWT");let b=c.key.split(":"),R=u(b[0]),T=u(b[1]),d=(await fetch(WpSuite.uploadUrl+"config.enc?t="+WpSuite.siteSettings.lastUpdate).then(p=>p.ok?p.text():null).catch(()=>null))?.split(":");if(d.length===2){let p=u(d[0]),U=u(d[1]),k=await crypto.subtle.importKey("raw",R,{name:"AES-GCM"},!1,["decrypt"]),v=await crypto.subtle.decrypt({name:"AES-GCM",iv:T},k,new Uint8Array([...p,...U]));t=JSON.parse(new TextDecoder().decode(v)),t.subscriptionType=c.subscriptionType}}catch(o){console.error(o.message)}}return t??null};E=w;C=S});f();var rt="hub-for-wpsuiteio",ot=async t=>{let n=await(await Promise.resolve().then(()=>(P(),A))).getConfig();return n&&(n={...n[t],subscriptionType:n.subscriptionType}),n};export{rt as TEXT_DOMAIN,K as decryptData,l as deobfuscate,ot as getConfig};

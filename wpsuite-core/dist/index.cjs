"use strict";var f=Object.defineProperty;var X=Object.getOwnPropertyDescriptor;var D=Object.getOwnPropertyNames;var O=Object.prototype.hasOwnProperty;var d=(t,e)=>()=>(t&&(e=t(t=0)),e);var _=(t,e)=>{for(var n in e)f(t,n,{get:e[n],enumerable:!0})},I=(t,e,n,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of D(e))!O.call(t,r)&&r!==n&&f(t,r,{get:()=>e[r],enumerable:!(o=X(e,r))||o.enumerable});return t};var Y=t=>I(f({},"__esModule",{value:!0}),t);function s(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");for(;e.length%4;)e+="=";return Uint8Array.from(atob(e),n=>n.charCodeAt(0))}var g,y=d(()=>{"use strict";g=(t,e)=>{let o=Uint8Array.from(atob(t),r=>r.charCodeAt(0)).map((r,a)=>r^e+a&255);return new TextDecoder().decode(o)}});var h,E,C=d(()=>{"use strict";y();h=g("XV1QR3plaWohKU1lfHMjc2xISnJuVi9pf04XS34WQlRwQkZFXn58SnoJVQ==",8),E=g("Xz1IcUt+dEx/dXZSd2BleFpgaF9XUnVHUkUabGtEeWhMSHJZdGVaWwBBZw==",8)});var U={};_(U,{getConfig:()=>F});function w(t){try{return new URL(t.includes("://")?t:`http://${t}`).hostname.toLowerCase()}catch{return t.replace(/\/+$/,"").toLowerCase()}}function H(t){let e=w(t);return e.startsWith("www.")?e.slice(4):e}function T(t){let e=w(t);if(M.test(e)||G.test(e)||e==="localhost")return!0;let n=(0,R.parse)(e,{allowPrivateDomains:!0});return!!(!n.domain||!n.publicSuffix||N.includes(n.publicSuffix))}function J(t){let e=w(t);return T(e)||A.test(e)?!0:e.split(".").some(n=>A.test(n))}function V(t){return T(t)||J(t)}function Z(t,e){return e?H(t)===e:!1}function j(t,e){return V(t)?{free:!0,covered:!0}:{free:!1,covered:Z(t,e)}}var u,R,P,x,m,A,N,M,G,F,k=d(()=>{"use strict";u=require("jose");C();y();R=require("tldts");typeof WpSuite<"u"?m=WpSuite.siteSettings:m={};A=/\b(dev|test|testing|staging|stage|qa|uat|preview|demo|sandbox|preprod|beta|canary)\b/i,N=["localhost","local","test","invalid","example","lan","internal"],M=/^(127\.)|^(10\.)|^(192\.168\.)|^(172\.(1[6-9]|2\d|3[0-1])\.)/,G=/^(::1$)|(^fc00:)|(^fd)/i;F=async()=>{let t=null;if(m.subscriber){let n=await(0,u.importJWK)({kty:"EC",x:P,y:x,crv:"P-256"},"ES256"),o=new Date().getFullYear(),r=Math.floor((Date.now()-new Date(o,0,1).getTime())/(1e3*60*60*24*7)),a=await fetch(WpSuite.uploadUrl+"lic.jws?t="+WpSuite.siteSettings.lastUpdate+"&y="+o+"&w="+r).then(i=>i.ok?i.text():null).catch(()=>null);if(a)try{let i=location.hostname.split(":")[0],{payload:l}=await(0,u.jwtVerify)(a,n,{algorithms:["ES256"]}),b=j(i,l.domain);if(!b.free&&!b.covered)throw new Error("Invalid domain in JWT");let S=l.key.split(":"),v=s(S[0]),L=s(S[1]),p=(await fetch(WpSuite.uploadUrl+"config.enc?t="+WpSuite.siteSettings.lastUpdate).then(c=>c.ok?c.text():null).catch(()=>null))?.split(":");if(p.length===2){let c=s(p[0]),W=s(p[1]),B=await crypto.subtle.importKey("raw",v,{name:"AES-GCM"},!1,["decrypt"]),K=await crypto.subtle.decrypt({name:"AES-GCM",iv:L},B,new Uint8Array([...c,...W]));t=JSON.parse(new TextDecoder().decode(K)),t.subscriptionType=l.subscriptionType}}catch(i){console.error(i.message)}}return t??null};P=h;x=E});var z={};_(z,{TEXT_DOMAIN:()=>$,getConfig:()=>q});module.exports=Y(z);var $="hub-for-wpsuiteio",q=async t=>{let n=await(await Promise.resolve().then(()=>(k(),U))).getConfig();return n&&(n={...n[t],subscriptionType:n.subscriptionType}),n};0&&(module.exports={TEXT_DOMAIN,getConfig});

"use strict";var b=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var V=Object.prototype.hasOwnProperty;var l=(t,e)=>()=>(t&&(e=t(t=0)),e);var h=(t,e)=>{for(var n in e)b(t,n,{get:e[n],enumerable:!0})},H=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of N(e))!V.call(t,i)&&i!==n&&b(t,i,{get:()=>e[i],enumerable:!(r=G(e,i))||r.enumerable});return t};var J=t=>H(b({},"__esModule",{value:!0}),t);function m(t,e){return`wpsuite:${t}:${e}`}function $(t,e=8e3){return()=>new Promise(n=>{if(t.status==="available")return n("available");if(t.status==="error")return n("error");!t.status||t.status;let r=m(t.key,"ready"),i=m(t.key,"error"),s=()=>u("available"),o=()=>u("error"),a,u=p=>{window.removeEventListener(r,s),window.removeEventListener(i,o),a!==void 0&&window.clearTimeout(a),n(p)};window.addEventListener(r,s,{once:!0}),window.addEventListener(i,o,{once:!0}),a=window.setTimeout(()=>u("unavailable"),e)})}function Z(t){return e=>{window.addEventListener(m(t,"ready"),()=>e(),{once:!0})}}function _(t,e){let n=e?.timeoutMs??8e3;return t.availability??=$(t,n),t.onReady??=Z(t.key),t}var x=l(()=>{"use strict"});function d(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");for(;e.length%4;)e+="=";return Uint8Array.from(atob(e),n=>n.charCodeAt(0))}var w,S=l(()=>{"use strict";w=(t,e)=>{let r=Uint8Array.from(atob(t),i=>i.charCodeAt(0)).map((i,s)=>i^e+s&255);return new TextDecoder().decode(r)}});var A,R,k=l(()=>{"use strict";S();A=w("lJaZiLOuoK348pS6paj6tKWDg72nneauhrXutIftu5O5iY+Kl7W1jaPSjA==",193),R=w("lvaBvoK1vYumrq+Nrru8v5OroZCembyAq77jk5K/gK+Fg7uWva6TnNmavg==",193)});var U={};h(U,{getConfig:()=>it});function P(t){try{return new URL(t.includes("://")?t:`http://${t}`).hostname.toLowerCase()}catch{return t.replace(/\/+$/,"").toLowerCase()}}function q(t){let e=P(t);return e.startsWith("www.")?e.slice(4):e}function B(t){let e=P(t);if(z.test(e)||F.test(e)||e==="localhost")return!0;let n=(0,L.parse)(e,{allowPrivateDomains:!0});return!!(!n.domain||!n.publicSuffix||j.includes(n.publicSuffix))}function Q(t){let e=P(t);return B(e)||C.test(e)?!0:e.split(".").some(n=>C.test(n))}function tt(t){return B(t)||Q(t)}function et(t,e){return e?q(t)===e:!1}function nt(t,e){return tt(t)?{free:!0,covered:!0}:{free:!1,covered:et(t,e)}}var f,L,T,W,c,v,C,j,z,F,it,K=l(()=>{"use strict";f=require("jose");k();S();D();L=require("tldts"),c=E();c?v=c.siteSettings:v={};C=/\b(dev|test|testing|staging|stage|qa|uat|preview|demo|sandbox|preprod|beta|canary)\b/i,j=["localhost","local","test","invalid","example","lan","internal"],z=/^(127\.)|^(10\.)|^(192\.168\.)|^(172\.(1[6-9]|2\d|3[0-1])\.)/,F=/^(::1$)|(^fc00:)|(^fd)/i;it=async()=>{let t=null;if(v.subscriber){let n=await(0,f.importJWK)({kty:"EC",x:T,y:W,crv:"P-256"},"ES256"),r=new Date().getFullYear(),i=Math.floor((Date.now()-new Date(r,0,1).getTime())/(1e3*60*60*24*7)),s=await fetch(c.uploadUrl+"lic.jws?t="+c.siteSettings.lastUpdate+"&y="+r+"&w="+i).then(o=>o.ok?o.text():null).catch(()=>null);if(s)try{let o=location.hostname.split(":")[0],{payload:a}=await(0,f.jwtVerify)(s,n,{algorithms:["ES256"]}),u=nt(o,a.domain);if(!u.free&&!u.covered)throw new Error("Invalid domain in JWT");let p=a.key.split(":"),O=d(p[0]),X=d(p[1]),y=(await fetch(c.uploadUrl+"config.enc?t="+c.siteSettings.lastUpdate).then(g=>g.ok?g.text():null).catch(()=>null))?.split(":");if(y?.length===2){let g=d(y[0]),I=d(y[1]),M=await crypto.subtle.importKey("raw",O,{name:"AES-GCM"},!1,["decrypt"]),Y=await crypto.subtle.decrypt({name:"AES-GCM",iv:X},M,new Uint8Array([...g,...I]));t=JSON.parse(new TextDecoder().decode(Y)),t.subscriptionType=a.subscriptionType}}catch(o){console.error(o.message)}}return t??null};T=A;W=R});var at={};h(at,{TEXT_DOMAIN:()=>ot,attachDefaultPluginRuntime:()=>_,getConfig:()=>st,getPlugin:()=>rt,getWpSuite:()=>E});module.exports=J(at);function E(){return globalThis.WpSuite}function rt(t){return globalThis.WpSuite?.plugins[t]}var ot,st,D=l(()=>{x();ot="hub-for-wpsuiteio",st=async t=>{let n=await(await Promise.resolve().then(()=>(K(),U))).getConfig();return n&&(n={...n[t],subscriptionType:n.subscriptionType}),n}});D();0&&(module.exports={TEXT_DOMAIN,attachDefaultPluginRuntime,getConfig,getPlugin,getWpSuite});

"use strict";var b=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var F=Object.prototype.hasOwnProperty;var l=(e,t)=>()=>(e&&(t=e(e=0)),t);var x=(e,t)=>{for(var n in t)b(e,n,{get:t[n],enumerable:!0})},H=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of V(t))!F.call(e,i)&&i!==n&&b(e,i,{get:()=>t[i],enumerable:!(r=N(t,i))||r.enumerable});return e};var J=e=>H(b({},"__esModule",{value:!0}),e);function d(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");for(;t.length%4;)t+="=";return Uint8Array.from(atob(t),n=>n.charCodeAt(0))}var w,E,f=l(()=>{"use strict";w=(e,t)=>{let r=Uint8Array.from(atob(e),i=>i.charCodeAt(0)).map((i,o)=>i^t+o&255);return new TextDecoder().decode(r)},E=async e=>{let t=globalThis.grecaptcha,n=e?t?.enterprise:void 0,r=n?.ready??t?.ready,i=n?.execute??t?.execute;if(typeof i!="function")return{execute:void 0};try{return typeof r=="function"&&await new Promise(o=>r(()=>o())),{execute:i}}catch{return{execute:void 0}}}});function v(e,t){return`wpsuite:${e}:${t}`}function $(e,t=8e3){return()=>new Promise(n=>{if(e.status==="available")return n("available");if(e.status==="error")return n("error");!e.status||e.status;let r=v(e.key,"ready"),i=v(e.key,"error"),o=()=>c("available"),s=()=>c("error"),a,c=p=>{window.removeEventListener(r,o),window.removeEventListener(i,s),a!==void 0&&window.clearTimeout(a),n(p)};window.addEventListener(r,o,{once:!0}),window.addEventListener(i,s,{once:!0}),a=window.setTimeout(()=>c("unavailable"),t)})}function Z(e){return t=>{window.addEventListener(v(e,"ready"),()=>t(),{once:!0})}}function _(e,t){let n=t?.timeoutMs??8e3;return e.availability??=$(e,n),e.onReady??=Z(e.key),e}var R=l(()=>{"use strict"});var A,k,C=l(()=>{"use strict";f();A=w("KyvazfTr4+C3v9f/4u256frewPjg2KXjyfit8cCo+O7G9MzP0PD2wOyfzw==",126),k=w("KUvC+8Xw/sbp4+zI6f7/4sz24tXZ3P/N5POg1tX6w9L6/vjT+uvQ0ZbX/Q==",126)});var K={};x(K,{getConfig:()=>re});function h(e){try{return new URL(e.includes("://")?e:`http://${e}`).hostname.toLowerCase()}catch{return e.replace(/\/+$/,"").toLowerCase()}}function Q(e){let t=h(e);return t.startsWith("www.")?t.slice(4):t}function U(e){let t=h(e);if(z.test(t)||q.test(t)||t==="localhost")return!0;let n=(0,B.parse)(t,{allowPrivateDomains:!0});return!!(!n.domain||!n.publicSuffix||j.includes(n.publicSuffix))}function ee(e){let t=h(e);return U(t)||T.test(t)?!0:t.split(".").some(n=>T.test(n))}function te(e){return U(e)||ee(e)}function ne(e,t){return t?Q(e)===t:!1}function ie(e,t){return te(e)?{free:!0,covered:!0}:{free:!1,covered:ne(e,t)}}var y,B,W,L,u,S,T,j,z,q,re,D=l(()=>{"use strict";y=require("jose");C();f();O();B=require("tldts"),u=P();u?S=u.siteSettings:S={};T=/\b(dev|test|testing|staging|stage|qa|uat|preview|demo|sandbox|preprod|beta|canary)\b/i,j=["localhost","local","test","invalid","example","lan","internal"],z=/^(127\.)|^(10\.)|^(192\.168\.)|^(172\.(1[6-9]|2\d|3[0-1])\.)/,q=/^(::1$)|(^fc00:)|(^fd)/i;re=async()=>{let e=null;if(S.subscriber){let n=await(0,y.importJWK)({kty:"EC",x:W,y:L,crv:"P-256"},"ES256"),r=new Date().getFullYear(),i=Math.floor((Date.now()-new Date(r,0,1).getTime())/(1e3*60*60*24*7)),o=await fetch(u.uploadUrl+"lic.jws?t="+u.siteSettings.lastUpdate+"&y="+r+"&w="+i).then(s=>s.ok?s.text():null).catch(()=>null);if(o)try{let s=location.hostname.split(":")[0],{payload:a}=await(0,y.jwtVerify)(o,n,{algorithms:["ES256"]}),c=ie(s,a.domain);if(!c.free&&!c.covered)throw new Error("Invalid domain in JWT");let p=a.key.split(":"),X=d(p[0]),G=d(p[1]),m=(await fetch(u.uploadUrl+"config.enc?t="+u.siteSettings.lastUpdate).then(g=>g.ok?g.text():null).catch(()=>null))?.split(":");if(m?.length===2){let g=d(m[0]),I=d(m[1]),M=await crypto.subtle.importKey("raw",X,{name:"AES-GCM"},!1,["decrypt"]),Y=await crypto.subtle.decrypt({name:"AES-GCM",iv:G},M,new Uint8Array([...g,...I]));e=JSON.parse(new TextDecoder().decode(Y)),e.subscriptionType=a.subscriptionType}}catch(s){console.error(s.message)}}return e??null};W=A;L=k});var ce={};x(ce,{TEXT_DOMAIN:()=>se,attachDefaultPluginRuntime:()=>_,getConfig:()=>ae,getPlugin:()=>oe,getRecaptcha:()=>E,getWpSuite:()=>P});module.exports=J(ce);function P(){return globalThis.WpSuite}function oe(e){return globalThis.WpSuite?.plugins[e]}var se,ae,O=l(()=>{f();R();se="smartcloud-wpsuite",ae=async e=>{let n=await(await Promise.resolve().then(()=>(D(),K))).getConfig();return n&&(n={...n[e],subscriptionType:n.subscriptionType}),n}});O();0&&(module.exports={TEXT_DOMAIN,attachDefaultPluginRuntime,getConfig,getPlugin,getRecaptcha,getWpSuite});

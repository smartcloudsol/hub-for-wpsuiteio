import{r as l,y as k,j as e,x as g,G as n,q as S,D as y}from"./index2.js";import{c as v,S as c,a as E,_ as B,T as r,C as o,b as d,B as u}from"./component.js";const P=[["path",{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4",key:"svg-0"}],["path",{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4",key:"svg-1"}]],R=v("outline","refresh","Refresh",P),m=g.getWpSuite();function L(){const[s,f]=l.useState(null),[a,x]=l.useState(!0),[h,j]=l.useState(null),w=k(`(max-width: ${y.breakpoints.sm})`),p=async()=>{try{x(!0),j(null);const i=await fetch(`${m.restUrl}/diagnostics`,{headers:{"X-WP-Nonce":m.nonce},credentials:"same-origin"});if(!i.ok)throw new Error(`HTTP ${i.status}`);const b=await i.json();f(b)}catch(i){j(i?.message||"Unknown error")}finally{x(!1)}};l.useEffect(()=>{p()},[]);const t=({ok:i})=>i===null?e.jsx(u,{children:"n/a"}):i?e.jsx(u,{color:"green",children:"OK"}):e.jsx(u,{color:"red",children:"Issue"});return e.jsxs(c,{p:"md",gap:"md",maw:1280,children:[e.jsx(E,{level:1,style:{display:"flex",alignItems:"center",gap:"8px",color:"#218BE6"},children:B(w?"WPSuite.io HUB":"Central Hub for WPSuite.io Plugins",g.TEXT_DOMAIN)}),e.jsxs(n,{justify:"space-between",children:[e.jsx(r,{children:"Quick checks to confirm your environment meets the minimum requirements for WPSuite.io Plugins. Use the Refresh button to re-run the tests; results reflect the current runtime."}),e.jsx(S,{leftSection:e.jsx(R,{size:16}),onClick:p,variant:"light",children:"Refresh"})]}),a&&e.jsx(o,{withBorder:!0,radius:"lg",p:"lg",children:e.jsxs(c,{children:[e.jsx(r,{children:"Loading diagnostics..."}),e.jsx(d,{height:12,radius:"xl"}),e.jsx(d,{height:12,radius:"xl"}),e.jsx(d,{height:12,radius:"xl"}),e.jsx(d,{height:12,radius:"xl"})]})}),!a&&h&&e.jsx(o,{withBorder:!0,radius:"lg",p:"lg",children:e.jsxs(r,{c:"red",children:["Failed to load diagnostics: ",h]})}),!a&&!h&&s&&e.jsxs(l.Fragment,{children:[e.jsxs(o,{withBorder:!0,radius:"lg",p:"lg",children:[e.jsx(r,{fw:600,mb:"xs",children:"Versions"}),e.jsxs(n,{justify:"space-between",children:[e.jsxs(c,{gap:4,children:[e.jsxs(r,{children:["WordPress: ",s.versions.wp.current," (required ≥"," ",s.versions.wp.required,")"]}),e.jsx(t,{ok:s.versions.wp.ok})]}),e.jsxs(c,{gap:4,children:[e.jsxs(r,{children:["PHP: ",s.versions.php.current," (required ≥"," ",s.versions.php.required,")"]}),e.jsx(t,{ok:s.versions.php.ok})]})]})]}),e.jsxs(o,{withBorder:!0,radius:"lg",p:"lg",children:[e.jsx(r,{fw:600,mb:"xs",children:"Connectivity"}),e.jsxs(c,{gap:"xs",children:[e.jsxs(n,{justify:"space-between",children:[e.jsxs(r,{children:["REST API:"," ",e.jsx(r,{span:!0,c:"dimmed",children:s.rest.url})]}),e.jsx(t,{ok:s.rest.ok})]}),s.rest.error&&e.jsxs(r,{c:"red",children:["REST error: ",s.rest.error]}),e.jsxs(n,{justify:"space-between",mt:"sm",children:[e.jsxs(r,{children:["Loopback:"," ",e.jsx(r,{span:!0,c:"dimmed",children:s.loopback.url})]}),e.jsx(t,{ok:s.loopback.ok})]}),s.loopback.error&&e.jsxs(r,{c:"red",children:["Loopback error: ",s.loopback.error]})]})]}),e.jsxs(o,{withBorder:!0,radius:"lg",p:"lg",children:[e.jsx(r,{fw:600,mb:"xs",children:"Uploads"}),e.jsxs(n,{justify:"space-between",children:[e.jsxs(r,{children:["Directory:"," ",e.jsx(r,{span:!0,c:"dimmed",children:s.uploads.basedir})]}),e.jsx(t,{ok:s.uploads.writable})]}),s.uploads.error&&e.jsxs(r,{c:"red",children:["Uploads error: ",s.uploads.error]})]}),e.jsxs(o,{withBorder:!0,radius:"lg",p:"lg",children:[e.jsx(r,{fw:600,mb:"xs",children:"SSL & Site URL"}),e.jsxs(n,{justify:"space-between",children:[e.jsx(r,{children:"SSL enabled"}),e.jsx(t,{ok:s.ssl.enabled})]}),e.jsx(r,{c:"dimmed",children:s.ssl.note}),e.jsxs(r,{mt:"sm",children:["Site URL:"," ",e.jsx(r,{span:!0,c:"dimmed",children:s.siteUrl})]})]})]})]})}export{L as default};
